import { Version } from "version.slint";
import { Theme } from "theme.slint";
import { Layout } from "layout.slint";
import { Configuration } from "configuration.slint";
import { Page } from "navigation/navigation.slint";
import { HomePage, SplashPage } from "pages/pages.slint";
import { AboutPopupPanel } from "panels/panels.slint";

export component AppWindow inherits Window {
  property<Page> page: Page.Splash;

  title: Version.name;

  default-font-size: Theme.default_font_size;

  preferred-width: Layout.preferred_window_width;
  preferred-height: Layout.preferred_window_height;
  
  callback about-popup();
  about-popup => { about_popup.show(); }

  callback open-github();
  
  Timer {
    interval: Configuration.splash_page_duration;
    running: true;
    triggered() => {
        page = Page.Home;
        self.running = false;
    }
  }

  about_popup := PopupWindow {
    x: root.width / 2 - self.width / 2;
    y: root.height / 2 - self.height / 2;
    close-policy: close-on-click-outside;

    AboutPopupPanel {}
  }

  if (page != Page.Splash):
  MenuBar {
    Menu {
      title: @tr("Help");
      MenuItem {
        title: @tr("About");
        activated => { about_popup.show(); }
      }
      //MenuSeparator {}
      MenuItem {
        title: @tr("GitHub");
        activated => { open-github(); }
      }
    }
  }

  VerticalLayout { // Required to maintain implicit size.
    if (page == Page.Splash): 
    SplashPage {}

    if (page == Page.Home): 
    HomePage {
      //width: 100%;
      //height: 100%;
    }
  }
}
